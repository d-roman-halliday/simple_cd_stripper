<!DOCTYPE html>
<html lang="en">
<head>
    <title>Simple CD Stripper</title>
    <meta charset="UTF-8">
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .url-input-container {
            margin-bottom: 10px;
        }
        .url-input {
            width: 80%;
            padding: 8px;
            margin-right: 10px;
        }
        .remove-url {
            background-color: #ff4444;
            color: white;
            border: none;
            padding: 8px 12px;
            cursor: pointer;
            border-radius: 4px;
        }
        #add-url {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 8px 12px;
            cursor: pointer;
            margin-bottom: 20px;
            border-radius: 4px;
        }
        #submit-form {
            background-color: #2196F3;
            color: white;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 16px;
            border-radius: 4px;
        }
        .error {
            color: red;
            display: none;
            margin-top: 10px;
        }
        .options {
            margin: 12px 0 18px;
        }
        .options label {
            user-select: none;
            cursor: pointer;
        }
    </style>
</head>
<body>
<h1>Simple CD Stripper</h1>
<p>Enter <a href="https://www.discogs.com/">Discogs</a> URLs to generate CD labels:</p>

<form id="url-form" action="/generate-label" method="post">
    <div id="url-inputs">
        <div class="url-input-container">
            <label>URL:
                <input type="text" class="url-input" name="url[]" placeholder="Enter Discogs URL" required>
            </label>
        </div>
    </div>

    <div class="options">
        <label>
            <input type="checkbox" name="title_bg" value="1">
            Yellow background behind title/artist
        </label>
    </div>

    <button type="button" id="add-url">+ Add Another URL</button>
    <br>
    <button type="submit" id="submit-form">Generate Labels</button>
</form>

<div id="error-message" class="error"></div>

<script>
    document.getElementById('add-url').addEventListener('click', function() {
        const container = document.createElement('div');
        container.className = 'url-input-container';

        const input = document.createElement('input');
        input.type = 'text';
        input.className = 'url-input';
        input.name = 'url[]';
        input.placeholder = 'Enter Discogs URL';
        input.required = true;

        const removeButton = document.createElement('button');
        removeButton.type = 'button';
        removeButton.className = 'remove-url';
        removeButton.textContent = 'âœ•';
        removeButton.onclick = function() {
            container.remove();
        };

        container.appendChild(input);
        container.appendChild(removeButton);
        document.getElementById('url-inputs').appendChild(container);
    });

    document.getElementById('url-form').addEventListener('submit', function(e) {
        e.preventDefault();

        // Options
        const options = document.getElementsByClassName('options');
        const titleBg = options[0].querySelector('input[name="title_bg"]').checked;

        // URLs
        const inputs = document.getElementsByClassName('url-input');
        const urls = Array.from(inputs).map(input => input.value.trim()).filter(url => url);

        if (urls.length === 0) {
            const errorDiv = document.getElementById('error-message');
            errorDiv.textContent = 'Please enter at least one URL';
            errorDiv.style.display = 'block';
            return;
        }

        // Create form data with all URLs
        const formData = new FormData();
        formData.append('url', urls.join(','));

        // Append options to the form data
        formData.append('title_bg', titleBg);

        // Submit the form
        fetch('/generate-label', {
            method: 'POST',
            body: formData
        })
            .then(response => {
                if (!response.ok) {
                    return response.json().then(data => {
                        throw new Error(data.error || 'Failed to generate labels');
                    });
                }
                return response.blob();
            })
            .then(blob => {
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'jukebox_labels.pdf';
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
            })
            .catch(error => {
                const errorDiv = document.getElementById('error-message');
                errorDiv.textContent = error.message;
                errorDiv.style.display = 'block';
            });
    });
</script>

<h1>Instructions</h1>
<h2>1: Enter Discogs Release or Master URL</h2>
<p>
    Something like: <code>https://www.discogs.com/master/41155-Ozzy-Osbourne-Blizzard-Of-Ozz</code>
</p>
<ul>
    <li>One Disk: <code>https://www.discogs.com/master/1326585-Jimmy-Ponder-While-My-Guitar-Gently-Weeps</code></li>
    <li>Multi Disk: <code>https://www.discogs.com/release/3992501-Various-While-My-Guitar-Gently-Weeps</code></li>
</ul>

<h2>2: Add more URLs (optional)</h2>
<p>
    Use the "+ Add Another URL" button to add another URL (4 disks max per output)
</p>
<h2>3: Generate</h2>
<p>
    Use the "Generate Labels" button and you should have a PDF with some tracks on it
</p>

<h1>About</h1>
<h2>The Jukebox</h2>
<p>
    This is inspired by a Sound Leisure Lime-Light CD jukebox (which olds 80 CDs): <a href="https://www.jukebox-world.de/Forum/Archiv/Sound%20Leisure/SoundLeisure-StarDust.htm">Sound Leisure im Archive Jukebox-World</a>
</p>
<h3>Label space</h3>
<ul>
    <li>Track Listing width: <var>7.5</var>cm. I've found working for the PDF: <var>74</var>mm</li>
    <li>Track Listing height: <var>11.5</var>cm. I've found working for the PDF: <var>109</var>mm</li>
    <li>Plus spaces for the CD book/cover art</li>
</ul>
<h3>General specs of this jukebox</h3>
<ul>
    <li>Cards: 75 mm wide 111 mm high</li>
    <li>Album art boxes</li>
    <li>H1020 x W638 x D310 mm; 60 kg</li>
</ul>
<h2>Project</h2>
<p>
    Code available on github:
</p>
<ul>
    <li><a href="https://github.com/d-roman-halliday/simple_cd_stripper">github.com/d-roman-halliday/simple_cd_stripper</a></li>
</ul>
<p>
    Created with some vibe coding. This is to fill a personal need, but who knows how it might be useful to others.
</p>
<p>
    Inspired by the PHP project I have:
</p>
<ul>
    <li><a href="https://simplestripper.roman-halliday.com/">simplestripper.roman-halliday.com</a></li>
    <li><a href="https://github.com/d-roman-halliday/simplestripper">github.com/d-roman-halliday/simplestripper</a></li>
</ul>

</body>
</html>